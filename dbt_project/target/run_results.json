{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-24T14:43:41.612157Z", "invocation_id": "d53b4abb-2266-487b-bd51-68d68eaf4e44", "invocation_started_at": "2025-09-24T14:43:34.529516Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:40.623836Z", "completed_at": "2025-09-24T14:43:40.643694Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:40.644687Z", "completed_at": "2025-09-24T14:43:40.644724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07314443588256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.techshop_2025.stg_customers", "compiled": true, "compiled_code": "-- dbt_project/models/staging/stg_customers.sql\n\n\nSELECT \n  customer_id,\n  first_name,\n  last_name,\n  LOWER(email) as email,\n  UPPER(country) as country_code,\n  city,\n  created_at,\n  customer_segment,\n  ROUND(lifetime_value, 2) as lifetime_value,\n  ROUND(avg_order_value, 2) as avg_order_value,\n  order_frequency,\n  SPLIT(preferred_categories, ',') as preferred_categories_array,\n  is_vip,\n  newsletter_subscriber,\n  mobile_app_user,\n  last_active_date,\n  \n  -- Calculs d\u00e9riv\u00e9s\n  DATE_DIFF(CURRENT_DATE(), created_at, DAY) as days_since_signup,\n  DATE_DIFF(CURRENT_DATE(), last_active_date, DAY) as days_since_last_active,\n  \n  -- Segmentation par anciennet\u00e9\n  CASE \n    WHEN DATE_DIFF(CURRENT_DATE(), created_at, DAY) <= 30 THEN 'New (0-30 days)'\n    WHEN DATE_DIFF(CURRENT_DATE(), created_at, DAY) <= 90 THEN 'Recent (31-90 days)' \n    WHEN DATE_DIFF(CURRENT_DATE(), created_at, DAY) <= 365 THEN 'Established (91-365 days)'\n    ELSE 'Veteran (1+ years)'\n  END as customer_tenure_segment,\n  \n  -- Statut d'activit\u00e9\n  CASE \n    WHEN DATE_DIFF(CURRENT_DATE(), last_active_date, DAY) <= 30 THEN 'Active'\n    WHEN DATE_DIFF(CURRENT_DATE(), last_active_date, DAY) <= 90 THEN 'At Risk'\n    ELSE 'Inactive' \n  END as activity_status\n\nFROM `techshop-data-pipeline-2025`.`raw_data`.`customers`", "relation_name": "`techshop-data-pipeline-2025`.`analytics_staging`.`stg_customers`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:40.699020Z", "completed_at": "2025-09-24T14:43:40.706442Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:40.707270Z", "completed_at": "2025-09-24T14:43:40.707301Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0593717098236084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.techshop_2025.stg_orders", "compiled": true, "compiled_code": "-- dbt_project/models/staging/stg_orders.sql\n\n\nSELECT \n  order_id,\n  customer_id,\n  order_date,\n  ROUND(total_amount, 2) as total_amount,\n  ROUND(shipping_cost, 2) as shipping_cost,\n  ROUND(total_amount - shipping_cost, 2) as subtotal,\n  payment_method,\n  order_status,\n  sales_channel,\n  num_items,\n  shipped_date,\n  delivered_date,\n  created_at,\n  \n  -- Calculs temporels\n  DATE_DIFF(shipped_date, order_date, DAY) as days_to_ship,\n  DATE_DIFF(delivered_date, shipped_date, DAY) as days_in_transit,\n  DATE_DIFF(delivered_date, order_date, DAY) as total_fulfillment_days,\n  \n  -- Segmentation par montant\n  CASE \n    WHEN total_amount < 50 THEN 'Low Value (<$50)'\n    WHEN total_amount < 150 THEN 'Medium Value ($50-$150)'\n    WHEN total_amount < 300 THEN 'High Value ($150-$300)'\n    ELSE 'Premium Value ($300+)'\n  END as order_value_segment,\n  \n  -- Indicateurs temporels 2025\n  EXTRACT(YEAR FROM order_date) as order_year,\n  EXTRACT(QUARTER FROM order_date) as order_quarter,\n  EXTRACT(MONTH FROM order_date) as order_month,\n  EXTRACT(DAYOFWEEK FROM order_date) as order_day_of_week,\n  FORMAT_DATE('%A', order_date) as order_day_name,\n  \n  -- Indicateurs saisonniers\n  CASE \n    WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'\n    WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'\n    WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'\n    ELSE 'Fall'\n  END as season,\n  \n  -- Indicateurs de performance\n  shipping_cost = 0 as is_free_shipping,\n  order_status = 'Completed' as is_completed,\n  sales_channel = 'Mobile App' as is_mobile_order\n\nFROM `techshop-data-pipeline-2025`.`raw_data`.`orders`\nWHERE order_date >= '2025-01-01'\n  AND order_date <= '2025-12-31'", "relation_name": "`techshop-data-pipeline-2025`.`analytics_staging`.`stg_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:40.760567Z", "completed_at": "2025-09-24T14:43:40.768203Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:40.769130Z", "completed_at": "2025-09-24T14:43:40.769169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06159210205078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.techshop_2025.stg_products", "compiled": true, "compiled_code": "-- dbt_project/models/staging/stg_products.sql\n\n\nSELECT \n  product_id,\n  sku,\n  product_name,\n  category,\n  subcategory,\n  brand,\n  ROUND(price, 2) as price,\n  ROUND(cost, 2) as cost,\n  ROUND(price - cost, 2) as margin_amount,\n  ROUND((price - cost) / price * 100, 2) as margin_percentage,\n  stock_quantity,\n  ROUND(avg_rating, 2) as avg_rating,\n  num_reviews,\n  launch_date,\n  weight,\n  is_eco_friendly,\n  is_ai_enabled,\n  is_bestseller,\n  created_at,\n  updated_at,\n  \n  -- Segmentation par prix\n  CASE \n    WHEN price < 50 THEN 'Budget (<$50)'\n    WHEN price < 150 THEN 'Mid-Range ($50-$150)'\n    WHEN price < 300 THEN 'Premium ($150-$300)'\n    ELSE 'Luxury ($300+)'\n  END as price_segment,\n  \n  -- Statut de popularit\u00e9\n  CASE \n    WHEN num_reviews >= 100 AND avg_rating >= 4.5 THEN 'Top Rated'\n    WHEN num_reviews >= 50 AND avg_rating >= 4.0 THEN 'Well Rated'\n    WHEN num_reviews >= 10 THEN 'Some Reviews'\n    ELSE 'New/Few Reviews'\n  END as review_status,\n  \n  -- Indicateurs 2025\n  EXTRACT(YEAR FROM launch_date) = 2025 as is_new_2025,\n  DATE_DIFF(CURRENT_DATE(), launch_date, DAY) as days_since_launch,\n  stock_quantity <= 10 as is_low_stock,\n  \n  -- Cat\u00e9gorisation avanc\u00e9e\n  CASE \n    WHEN is_eco_friendly AND is_ai_enabled THEN 'Eco-AI Product'\n    WHEN is_eco_friendly THEN 'Eco-Friendly'\n    WHEN is_ai_enabled THEN 'AI-Enabled'\n    ELSE 'Standard'\n  END as product_innovation_type\n\nFROM `techshop-data-pipeline-2025`.`raw_data`.`products`", "relation_name": "`techshop-data-pipeline-2025`.`analytics_staging`.`stg_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:40.825963Z", "completed_at": "2025-09-24T14:43:40.847000Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:40.847898Z", "completed_at": "2025-09-24T14:43:40.847929Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07438111305236816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_not_null_raw_data_customers_customer_id.5f7576ec6b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom `techshop-data-pipeline-2025`.`raw_data`.`customers`\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:40.902652Z", "completed_at": "2025-09-24T14:43:40.910948Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:40.911718Z", "completed_at": "2025-09-24T14:43:40.911748Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.060810089111328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_not_null_raw_data_marketing_campaigns_campaign_id.aed14aab9c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom `techshop-data-pipeline-2025`.`raw_data`.`marketing_campaigns`\nwhere campaign_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:40.965915Z", "completed_at": "2025-09-24T14:43:40.974366Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:40.975503Z", "completed_at": "2025-09-24T14:43:40.975527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06424760818481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_not_null_raw_data_order_items_order_id.a98cf18406", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom `techshop-data-pipeline-2025`.`raw_data`.`order_items`\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.032727Z", "completed_at": "2025-09-24T14:43:41.042633Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.043778Z", "completed_at": "2025-09-24T14:43:41.043811Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06327939033508301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_not_null_raw_data_order_items_product_id.5ac97549a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `techshop-data-pipeline-2025`.`raw_data`.`order_items`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.099440Z", "completed_at": "2025-09-24T14:43:41.108436Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.109283Z", "completed_at": "2025-09-24T14:43:41.109307Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06161904335021973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_not_null_raw_data_orders_customer_id.6c7f10cde9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom `techshop-data-pipeline-2025`.`raw_data`.`orders`\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.163022Z", "completed_at": "2025-09-24T14:43:41.171368Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.172181Z", "completed_at": "2025-09-24T14:43:41.172205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06179070472717285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_not_null_raw_data_orders_order_id.840e0f87e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom `techshop-data-pipeline-2025`.`raw_data`.`orders`\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.227390Z", "completed_at": "2025-09-24T14:43:41.235889Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.236862Z", "completed_at": "2025-09-24T14:43:41.236894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.060819387435913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_not_null_raw_data_products_product_id.135fb6ffe4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `techshop-data-pipeline-2025`.`raw_data`.`products`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.291361Z", "completed_at": "2025-09-24T14:43:41.303429Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.304343Z", "completed_at": "2025-09-24T14:43:41.304375Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06461143493652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_unique_raw_data_customers_customer_id.0090285856", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customer_id as unique_field\n  from `techshop-data-pipeline-2025`.`raw_data`.`customers`\n  where customer_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.358007Z", "completed_at": "2025-09-24T14:43:41.368243Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.369118Z", "completed_at": "2025-09-24T14:43:41.369148Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06270599365234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_unique_raw_data_marketing_campaigns_campaign_id.0354a14a2b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select campaign_id as unique_field\n  from `techshop-data-pipeline-2025`.`raw_data`.`marketing_campaigns`\n  where campaign_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.423361Z", "completed_at": "2025-09-24T14:43:41.431776Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.432618Z", "completed_at": "2025-09-24T14:43:41.432641Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06063342094421387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_unique_raw_data_orders_order_id.9b90266fc8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_id as unique_field\n  from `techshop-data-pipeline-2025`.`raw_data`.`orders`\n  where order_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.486576Z", "completed_at": "2025-09-24T14:43:41.494532Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.495435Z", "completed_at": "2025-09-24T14:43:41.495458Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.060873985290527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.techshop_2025.source_unique_raw_data_products_product_id.6029824217", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `techshop-data-pipeline-2025`.`raw_data`.`products`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T14:43:41.549763Z", "completed_at": "2025-09-24T14:43:41.557301Z"}, {"name": "execute", "started_at": "2025-09-24T14:43:41.558120Z", "completed_at": "2025-09-24T14:43:41.558153Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05973196029663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.techshop_2025.fct_sales", "compiled": true, "compiled_code": "-- dbt_project/models/marts/fct_sales.sql\n\n\n\nSELECT \n  o.order_id,\n  o.customer_id,\n  oi.product_id,\n  o.order_date,\n  o.order_year,\n  o.order_quarter,\n  o.order_month,\n  o.season,\n  o.sales_channel,\n  o.payment_method,\n  \n  -- Informations client\n  c.customer_segment,\n  c.customer_tenure_segment,\n  c.activity_status,\n  c.country_code,\n  c.is_vip,\n  \n  -- Informations produit\n  p.category,\n  p.subcategory,\n  p.brand,\n  p.price_segment,\n  p.product_innovation_type,\n  \n  -- M\u00e9triques de commande\n  oi.quantity,\n  oi.unit_price,\n  oi.total_price,\n  o.total_amount as order_total,\n  o.shipping_cost,\n  o.num_items as total_items_in_order,\n  \n  -- M\u00e9triques d\u00e9riv\u00e9es\n  ROUND(oi.total_price / o.total_amount * 100, 2) as item_contribution_pct,\n  p.cost * oi.quantity as total_cost,\n  (oi.unit_price - p.cost) * oi.quantity as total_margin,\n  ROUND((oi.unit_price - p.cost) / oi.unit_price * 100, 2) as margin_percentage,\n  \n  -- Indicateurs\n  o.is_completed,\n  o.is_free_shipping,\n  o.is_mobile_order,\n  p.is_eco_friendly,\n  p.is_ai_enabled,\n  p.is_bestseller,\n  \n  -- M\u00e9triques temporelles\n  o.days_to_ship,\n  o.total_fulfillment_days\n\nFROM `techshop-data-pipeline-2025`.`analytics_staging`.`stg_orders` o\nJOIN `techshop-data-pipeline-2025`.`raw_data`.`order_items` oi \n  ON o.order_id = oi.order_id\nJOIN `techshop-data-pipeline-2025`.`analytics_staging`.`stg_customers` c \n  ON o.customer_id = c.customer_id  \nJOIN `techshop-data-pipeline-2025`.`analytics_staging`.`stg_products` p \n  ON oi.product_id = p.product_id\nWHERE o.is_completed = TRUE", "relation_name": "`techshop-data-pipeline-2025`.`analytics_marts`.`fct_sales`", "batch_results": null}], "elapsed_time": 1.8486683368682861, "args": {"warn_error_options": {"error": [], "warn": [], "silence": []}, "skip_nodes_if_on_run_start_fails": false, "strict_mode": false, "print": true, "cache_selected_only": false, "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "use_colors": true, "version_check": true, "require_batched_execution_for_custom_microbatch_strategy": false, "exclude": [], "log_format_file": "debug", "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "indirect_selection": "eager", "write_json": true, "quiet": false, "show_resource_report": false, "invocation_command": "dbt docs generate", "static": false, "defer": false, "project_dir": "/opt/app/bigquery-projects/techshop-data-pipeline-2025/dbt_project", "profiles_dir": "/home/bquser/.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "log_level_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "require_all_warnings_handled_by_warn_error": false, "log_path": "/opt/app/bigquery-projects/techshop-data-pipeline-2025/dbt_project/logs", "which": "generate", "require_generic_test_arguments_property": true, "populate_cache": true, "log_format": "default", "select": [], "source_freshness_run_project_hooks": true, "compile": true, "upload_to_artifacts_ingest_api": false, "log_level": "info", "require_resource_names_without_spaces": true, "use_fast_test_edges": false, "validate_macro_args": false, "static_parser": true, "printer_width": 80, "empty_catalog": false, "favor_state": false, "log_file_max_bytes": 10485760, "introspect": true, "state_modified_compare_more_unrendered_values": false, "vars": {}, "macro_debugging": false, "partial_parse": true, "use_colors_file": true, "show_all_deprecations": false}}