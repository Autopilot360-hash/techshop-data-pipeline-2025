{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.11", "generated_at": "2025-09-24T19:13:38.720531Z", "invocation_id": "ebb6fc03-425a-4c2b-9654-5aa224bd8490", "invocation_started_at": "2025-09-24T19:13:15.505500Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T19:13:29.398321Z", "completed_at": "2025-09-24T19:13:29.414336Z"}, {"name": "execute", "started_at": "2025-09-24T19:13:29.415163Z", "completed_at": "2025-09-24T19:13:30.379178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9850659370422363, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "techshop-data-pipeline-2025", "job_id": "73d4a09b-1725-427c-93da-cae691e9dc96", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.techshop_2025.stg_customers", "compiled": true, "compiled_code": "-- dbt_project/models/staging/stg_customers.sql\n\n\nSELECT \n  customer_id,\n  first_name,\n  last_name,\n  LOWER(email) as email,\n  UPPER(country) as country_code,\n  city,\n  created_at,\n  customer_segment,\n  ROUND(lifetime_value, 2) as lifetime_value,\n  ROUND(avg_order_value, 2) as avg_order_value,\n  order_frequency,\n  SPLIT(preferred_categories, ',') as preferred_categories_array,\n  is_vip,\n  newsletter_subscriber,\n  mobile_app_user,\n  last_active_date,\n  \n  -- Calculs d\u00e9riv\u00e9s\n  DATE_DIFF(CURRENT_DATE(), created_at, DAY) as days_since_signup,\n  DATE_DIFF(CURRENT_DATE(), last_active_date, DAY) as days_since_last_active,\n  \n  -- Segmentation par anciennet\u00e9\n  CASE \n    WHEN DATE_DIFF(CURRENT_DATE(), created_at, DAY) <= 30 THEN 'New (0-30 days)'\n    WHEN DATE_DIFF(CURRENT_DATE(), created_at, DAY) <= 90 THEN 'Recent (31-90 days)' \n    WHEN DATE_DIFF(CURRENT_DATE(), created_at, DAY) <= 365 THEN 'Established (91-365 days)'\n    ELSE 'Veteran (1+ years)'\n  END as customer_tenure_segment,\n  \n  -- Statut d'activit\u00e9\n  CASE \n    WHEN DATE_DIFF(CURRENT_DATE(), last_active_date, DAY) <= 30 THEN 'Active'\n    WHEN DATE_DIFF(CURRENT_DATE(), last_active_date, DAY) <= 90 THEN 'At Risk'\n    ELSE 'Inactive' \n  END as activity_status\n\nFROM `techshop-data-pipeline-2025`.`raw_data`.`customers`", "relation_name": "`techshop-data-pipeline-2025`.`staging`.`stg_customers`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T19:13:30.392197Z", "completed_at": "2025-09-24T19:13:30.401555Z"}, {"name": "execute", "started_at": "2025-09-24T19:13:30.402444Z", "completed_at": "2025-09-24T19:13:31.618219Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.230696678161621, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "techshop-data-pipeline-2025", "job_id": "f41e630e-e699-4748-abb5-2dacdcf20067", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.techshop_2025.stg_orders", "compiled": true, "compiled_code": "-- dbt_project/models/staging/stg_orders.sql\n\n\nSELECT \n  order_id,\n  customer_id,\n  order_date,\n  ROUND(total_amount, 2) as total_amount,\n  ROUND(shipping_cost, 2) as shipping_cost,\n  ROUND(total_amount - shipping_cost, 2) as subtotal,\n  payment_method,\n  order_status,\n  sales_channel,\n  num_items,\n  shipped_date,\n  delivered_date,\n  created_at,\n  \n  -- Calculs temporels\n  DATE_DIFF(shipped_date, order_date, DAY) as days_to_ship,\n  DATE_DIFF(delivered_date, shipped_date, DAY) as days_in_transit,\n  DATE_DIFF(delivered_date, order_date, DAY) as total_fulfillment_days,\n  \n  -- Segmentation par montant\n  CASE \n    WHEN total_amount < 50 THEN 'Low Value (<$50)'\n    WHEN total_amount < 150 THEN 'Medium Value ($50-$150)'\n    WHEN total_amount < 300 THEN 'High Value ($150-$300)'\n    ELSE 'Premium Value ($300+)'\n  END as order_value_segment,\n  \n  -- Indicateurs temporels 2025\n  EXTRACT(YEAR FROM order_date) as order_year,\n  EXTRACT(QUARTER FROM order_date) as order_quarter,\n  EXTRACT(MONTH FROM order_date) as order_month,\n  EXTRACT(DAYOFWEEK FROM order_date) as order_day_of_week,\n  FORMAT_DATE('%A', order_date) as order_day_name,\n  \n  -- Indicateurs saisonniers\n  CASE \n    WHEN EXTRACT(MONTH FROM order_date) IN (12, 1, 2) THEN 'Winter'\n    WHEN EXTRACT(MONTH FROM order_date) IN (3, 4, 5) THEN 'Spring'\n    WHEN EXTRACT(MONTH FROM order_date) IN (6, 7, 8) THEN 'Summer'\n    ELSE 'Fall'\n  END as season,\n  \n  -- Indicateurs de performance\n  shipping_cost = 0 as is_free_shipping,\n  order_status = 'Completed' as is_completed,\n  sales_channel = 'Mobile App' as is_mobile_order\n\nFROM `techshop-data-pipeline-2025`.`raw_data`.`orders`\nWHERE order_date >= '2025-01-01'\n  AND order_date <= '2025-12-31'", "relation_name": "`techshop-data-pipeline-2025`.`staging`.`stg_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T19:13:31.629396Z", "completed_at": "2025-09-24T19:13:31.636764Z"}, {"name": "execute", "started_at": "2025-09-24T19:13:31.637631Z", "completed_at": "2025-09-24T19:13:32.647878Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0238702297210693, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "US", "project_id": "techshop-data-pipeline-2025", "job_id": "eb1fc127-ec40-4e61-ab6a-0dcef97b2911", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.techshop_2025.stg_products", "compiled": true, "compiled_code": "-- dbt_project/models/staging/stg_products.sql\n\n\nSELECT \n  product_id,\n  sku,\n  product_name,\n  category,\n  subcategory,\n  brand,\n  ROUND(price, 2) as price,\n  ROUND(cost, 2) as cost,\n  ROUND(price - cost, 2) as margin_amount,\n  ROUND((price - cost) / price * 100, 2) as margin_percentage,\n  stock_quantity,\n  ROUND(avg_rating, 2) as avg_rating,\n  num_reviews,\n  launch_date,\n  weight,\n  is_eco_friendly,\n  is_ai_enabled,\n  is_bestseller,\n  created_at,\n  updated_at,\n  \n  -- Segmentation par prix\n  CASE \n    WHEN price < 50 THEN 'Budget (<$50)'\n    WHEN price < 150 THEN 'Mid-Range ($50-$150)'\n    WHEN price < 300 THEN 'Premium ($150-$300)'\n    ELSE 'Luxury ($300+)'\n  END as price_segment,\n  \n  -- Statut de popularit\u00e9\n  CASE \n    WHEN num_reviews >= 100 AND avg_rating >= 4.5 THEN 'Top Rated'\n    WHEN num_reviews >= 50 AND avg_rating >= 4.0 THEN 'Well Rated'\n    WHEN num_reviews >= 10 THEN 'Some Reviews'\n    ELSE 'New/Few Reviews'\n  END as review_status,\n  \n  -- Indicateurs 2025\n  EXTRACT(YEAR FROM launch_date) = 2025 as is_new_2025,\n  DATE_DIFF(CURRENT_DATE(), launch_date, DAY) as days_since_launch,\n  stock_quantity <= 10 as is_low_stock,\n  \n  -- Cat\u00e9gorisation avanc\u00e9e\n  CASE \n    WHEN is_eco_friendly AND is_ai_enabled THEN 'Eco-AI Product'\n    WHEN is_eco_friendly THEN 'Eco-Friendly'\n    WHEN is_ai_enabled THEN 'AI-Enabled'\n    ELSE 'Standard'\n  END as product_innovation_type\n\nFROM `techshop-data-pipeline-2025`.`raw_data`.`products`", "relation_name": "`techshop-data-pipeline-2025`.`staging`.`stg_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-24T19:13:32.659897Z", "completed_at": "2025-09-24T19:13:32.668310Z"}, {"name": "execute", "started_at": "2025-09-24T19:13:32.669543Z", "completed_at": "2025-09-24T19:13:38.659281Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.003573179244995, "adapter_response": {"_message": "CREATE TABLE (189.7k rows, 19.2 MiB processed)", "code": "CREATE TABLE", "rows_affected": 189671, "bytes_processed": 20110807, "bytes_billed": 41943040, "location": "US", "project_id": "techshop-data-pipeline-2025", "job_id": "abf03bc5-6333-4069-beae-1d62209515a7", "slot_ms": 551358}, "message": "CREATE TABLE (189.7k rows, 19.2 MiB processed)", "failures": null, "unique_id": "model.techshop_2025.fct_sales", "compiled": true, "compiled_code": "-- dbt_project/models/marts/fct_sales.sql\n\n\n\nSELECT \n  o.order_id,\n  o.customer_id,\n  oi.product_id,\n  o.order_date,\n  o.order_year,\n  o.order_quarter,\n  o.order_month,\n  o.season,\n  o.sales_channel,\n  o.payment_method,\n  \n  -- Informations client\n  c.customer_segment,\n  c.customer_tenure_segment,\n  c.activity_status,\n  c.country_code,\n  c.is_vip,\n  \n  -- Informations produit\n  p.category,\n  p.subcategory,\n  p.brand,\n  p.price_segment,\n  p.product_innovation_type,\n  \n  -- M\u00e9triques de commande\n  oi.quantity,\n  oi.unit_price,\n  oi.total_price,\n  o.total_amount as order_total,\n  o.shipping_cost,\n  o.num_items as total_items_in_order,\n  \n  -- M\u00e9triques d\u00e9riv\u00e9es\n  ROUND(oi.total_price / o.total_amount * 100, 2) as item_contribution_pct,\n  p.cost * oi.quantity as total_cost,\n  (oi.unit_price - p.cost) * oi.quantity as total_margin,\n  ROUND((oi.unit_price - p.cost) / oi.unit_price * 100, 2) as margin_percentage,\n  \n  -- Indicateurs\n  o.is_completed,\n  o.is_free_shipping,\n  o.is_mobile_order,\n  p.is_eco_friendly,\n  p.is_ai_enabled,\n  p.is_bestseller,\n  \n  -- M\u00e9triques temporelles\n  o.days_to_ship,\n  o.total_fulfillment_days\n\nFROM `techshop-data-pipeline-2025`.`staging`.`stg_orders` o\nJOIN `techshop-data-pipeline-2025`.`raw_data`.`order_items` oi \n  ON o.order_id = oi.order_id\nJOIN `techshop-data-pipeline-2025`.`staging`.`stg_customers` c \n  ON o.customer_id = c.customer_id  \nJOIN `techshop-data-pipeline-2025`.`staging`.`stg_products` p \n  ON oi.product_id = p.product_id\nWHERE o.is_completed = TRUE", "relation_name": "`techshop-data-pipeline-2025`.`marts`.`fct_sales`", "batch_results": null}], "elapsed_time": 13.544539213180542, "args": {"cache_selected_only": false, "printer_width": 80, "log_format_file": "debug", "source_freshness_run_project_hooks": true, "vars": {}, "select": [], "state_modified_compare_vars": false, "empty": false, "profiles_dir": "/home/bquser/.dbt", "show_all_deprecations": false, "introspect": true, "partial_parse": true, "which": "run", "write_json": true, "project_dir": "/opt/app/bigquery-projects/techshop-data-pipeline-2025/dbt_project", "exclude": [], "use_colors_file": true, "favor_state": false, "print": true, "log_level": "info", "indirect_selection": "eager", "quiet": false, "show_resource_report": false, "require_explicit_package_overrides_for_builtin_materializations": true, "static_parser": true, "version_check": true, "require_batched_execution_for_custom_microbatch_strategy": false, "skip_nodes_if_on_run_start_fails": false, "require_resource_names_without_spaces": true, "log_format": "default", "log_level_file": "debug", "require_all_warnings_handled_by_warn_error": false, "partial_parse_file_diff": true, "state_modified_compare_more_unrendered_values": false, "use_fast_test_edges": false, "defer": false, "upload_to_artifacts_ingest_api": false, "use_colors": true, "require_yaml_configuration_for_mf_time_spines": false, "require_nested_cumulative_type_params": false, "require_generic_test_arguments_property": true, "log_file_max_bytes": 10485760, "populate_cache": true, "send_anonymous_usage_stats": true, "invocation_command": "dbt run", "warn_error_options": {"error": [], "warn": [], "silence": []}, "macro_debugging": false, "strict_mode": false, "log_path": "/opt/app/bigquery-projects/techshop-data-pipeline-2025/dbt_project/logs", "validate_macro_args": false}}